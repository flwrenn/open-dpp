# Repository settings for use with Probot Settings app
# https://github.com/apps/settings
#
# This file allows you to manage repository settings as code.
# To use: Install the "Settings" GitHub App on your repository.

# Repository settings
repository:
  name: open-dpp
  description: Open-source Digital Product Passport (DPP) implementation for product lifecycle transparency and sustainability tracking
  homepage: ''
  topics: dpp, digital-product-passport, sustainability, blockchain, nestjs, nextjs, typescript
  private: false
  has_issues: true
  has_projects: true
  has_wiki: false
  has_downloads: true
  default_branch: main
  allow_squash_merge: true
  allow_merge_commit: false
  allow_rebase_merge: true
  delete_branch_on_merge: true
  enable_automated_security_fixes: true
  enable_vulnerability_alerts: true

# Branch protection rules
branches:
  # Protect main branch
  - name: main
    protection:
      # Require pull request reviews before merging
      required_pull_request_reviews:
        # Number of required approvals
        required_approving_review_count: 1
        # Dismiss stale reviews when new commits are pushed
        dismiss_stale_reviews: true
        # Require review from code owners
        require_code_owner_reviews: false
        # Require last push approval (GitHub Enterprise only)
        # require_last_push_approval: false

      # Require status checks to pass before merging
      required_status_checks:
        # Require branches to be up to date before merging
        strict: true
        # List of required status checks
        # Note: Add these after CI runs at least once
        contexts:
          - 'lint-and-format'
          - 'ci-success'

      # Enforce all configured restrictions for administrators
      enforce_admins: true

      # Require conversation resolution before merging
      required_conversation_resolution: true

      # Restrictions on who can push to the branch
      # Leave empty to allow all users with write access
      restrictions: null

      # Prevent force pushes
      allow_force_pushes: false

      # Prevent branch deletion
      allow_deletions: false

      # Require signed commits
      required_signatures: false

      # Lock branch (read-only)
      lock_branch: false

      # Require linear history
      required_linear_history: false

  # Protect develop branch
  - name: develop
    protection:
      required_pull_request_reviews:
        required_approving_review_count: 1
        dismiss_stale_reviews: true
        require_code_owner_reviews: false
      required_status_checks:
        strict: true
        contexts:
          - 'lint-and-format'
          - 'ci-success'
      enforce_admins: false
      required_conversation_resolution: true
      restrictions: null
      allow_force_pushes: false
      allow_deletions: false
